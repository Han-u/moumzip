# 구해줘 홈즈

## 0. 프로젝트 개요
- 구해줘 홈즈는 온라인 부동산 정보 제공 서비스로, 부동산 시장에 관심 있는 사용자에게 부동산 투자나 주거에 도움이 되는 지역별 부동산 실거래가 정보를 제공한다.
### 목표
- 관통 프로젝트를 통해 1학기동안 배운 Spring 정복하기
- 프로젝트 설계시 각 기술의 장단점 특징 등 고려하기
- 성능, 확장, 유연성을 고려하여 설계하기

## 1. 요구사항 분석
### 1) 사용자 정의
1. admin
- 구해줘 홈즈 서비스 관리자
- 사용자 신고 및 부정 사용자, 규칙 위반 글을 관리한다.
2. 일반 회원
- 서비스를 이용하는 일반 사용자
- 회원 가입을 통해 정보를 등록하고 관심 지역 및 매물을 등록할 수 있다.
- 부동산 실거래 정보를 조회 및 검색할 수 있다.
- 등록된 매물을 조회할 수 있다.
- 사용자는 커뮤니티 게시글을 작성할 수 있다.
3. 부동산 중개업자
- 구해줘 홈즈를 통해 매물을 중개하는 사용자
- 게시판을 통해 매물을 게시할 수 있다.

### 2) 사용자 별 요구사항
1. admin
- 부정 사용자를 차단할 수 있다.
- 게시글 규칙 위반 글, 댓글을 삭제, 숨김처리 할 수 있다.
- 사용자의 신고 요청을 조회 및 처리할 수 있다.
- 사용자 검색 및 정보를 확인할 수 있다.
2. 일반 회원
- 회원 가입 및 탈퇴를 할 수 있다.
- 회원 정보, 비밀번호를 수정할 수 있다.
- 비밀번호 찾기를 할 수 있다.
- 로그인을 할 수 있다.
- 관심 지역 및 매물을 등록할 수 있다.
- 아파트 실거래가 내역을 조회할 수 있다.
- 게시판을 통해 부동산 매물을 조회할 수 있다.
- 사용자는 커뮤니티 게시글을 작성할 수 있다.
- 사용자는 커뮤니티 댓글을 작성할 수 있다.
3. 부동산 중개업자
- 회원 가입 및 탈퇴를 할 수 있다.
- 회원 정보, 비밀번호를 수정할 수 있다.
- 비밀번호 찾기를 할 수 있다.
- 로그인을 할 수 있다.
- 게시판을 통해 매물을 게시, 수정, 삭제를 할 수 있다.

### 3) 도메인 분석
- 법정동 코드
  - 10자리로 이루어진 숫자 ex)1234567890
  - 시도(2)+시군구(3)+읍면동(3)+법정리(2)
- 부동산 실거래 내역
  - 주택정보) 주소, 건축년도
  - 거래정보) 계약일, 거래 금액, 건축년도, 전용면적, 층
- 매물 정보
  - 주택정보) 주소, 총주차대수, 엘리베이터, 준공일
  - 매물정보) 층, 전용면적, 주차가능여부, 입주가능일, 월세, 관리비, 설명, 이미지, 중개인
- 공인중개사
  - 중개사무소명, 대표자명, 사업자번호, 중개사무소등록번호, 대표전화번호, 주소

### 4) 비기능 요구사항
- 비밀번호
  - 비밀번호는 암호화해 저장되어야한다.
  - 유저별로 다른 salt를 사용한다.
  - 로그인 시도가 지속적으로 반복될시 계정 잠겨야한다.
- XSS, CSRF 공격 방지
  - 사용자 입력값 검증
- JWT 토큰
  - 사용자 로그인 정보는 JWT를 사용한다.
  - accessToken, refreshToken 구현한다.
- 권한
  - 권한이 필요한 메뉴는 인증된 사용자만 접근할 수 있도록 한다.
- SSL 인증서 적용

## 2. 설계
### 1) 기능명세
1. 회원(공통)
   - 회원가입
     - 일반 회원 - 중개맨 회원가입 페이지 나누기 
     - 필수) 로그인 이메일, 이름, 닉네임 
     - 선택) 휴대폰번호, 프로필 이미지
     - 사용자별 salt 생성, 암호화해 DB에 저장
   - 로그인
     - 입력값) 로그인 이메일, 비밀번호
     - 로그인 락 기준) 로그인 시도 5번, 로그인 시도시간: 60분
     - accessToken) 1h 
     - refreshToken) 24h
   - 로그아웃
     - 발급된 토큰: ??
   - 회원 정보 수정
     - 닉네임, 휴대폰번호, 프로필 이미지 수정 가능
     - 비밀번호 수정 가능
   - 비밀번호 찾기
     - 등록된 이메일로 임시 비밀번호 발송
   - 회원 탈퇴
     - 계정 비활성화
     - N일 계정 보관 이후 영구 삭제
2. 중개맨
   - 회원가입시 중개사무소 정보 입력
     - 중개사무소명, 대표자명, 사업자번호, 중개사무소 등록번호, 대표전화번호, 주소, 본인이름, 휴대폰번호
   - 매물 등록
     - 주택정보) 주소, 총주차대수, 엘리베이터, 준공일
       매물정보) 층, 전용면적, 주차가능여부, 입주가능일, 가격, 관리비, 설명, 이미지, 중개인
     - 이미지 등록 가능 조건) 용량, 포맷, 개수, 크기 등
   - 매물 수정
     - 등록 정보 + 상태
   - 매물 삭제
3. 일반 회원 관심 설정
   - 관심 지역 설정
     - 사용자 시도 - 구군 - 동순으로 지정
     - N개까지 지정 가능
   - 관심 매물 설정
4. 부동산 정보
   - 지역 설정
     - 시도 - 구군 - 동순으로 지정
   - 부동산 거래 정보 조회
     - 위에서 설정한 지역 기준으로 조회
     - 결과) 페이지네이션? 몇건까지
5. 부동산 커뮤니티
   - 글 작성
     - 제목, 내용
   - 수정
     - 제목, 내용
   - 삭제
   - 조회
     - 제목, 내용, 작성자, 작성일
     - 페이지.......

   
### 2) API
- 수정예정.....   

| 제목                      | 내용     | 설명          |
|-------------------------|--------|-------------|
| /api/members            | POST   | 회원 가입       |
| /api/members/{memberId} | GET    | 정보 조회       |
| /api/members/{memberId} | PATCH  | 정보 수정       |
| /api/members/{memberId} | DELETE | 회원 탈퇴       |
| /api/auth/login         | POST   | 로그인         |
| /api/auth/logout        | POST   | 로그아웃        |
| /api/members/password   | POST   | 비밀번호 찾기     |
| /api/?                  | GET    | 거래 정보 조회    |
| /api/?/{}               | GET    | 매물 검색 단건    |
| /api/?                  | GET    | 매물 검색       |
| /api/?                  | POST   | 매물 등록       |
| /api/?/{}               | PATCH  | 매물 수정       |
| /api/?/{}               | DELETE | 매물 삭제       |
| /api/?                  | GET    | 즐겨찾기 동네 리스트 |
| /api/?                  | POST   | 즐겨찾기 동네 추가  |
| /api/?/{}               | DELETE | 즐겨찾기 동네 삭제  |
| /api/?                  | GET    | 즐겨찾기 매물 리스트 |
| /api/?                  | POST   | 즐겨찾기 매물 추가  |
| /api/?/{}               | DELETE | 즐겨찾기 매물 삭제  |

### 3) DB
- 토큰 DB 저장방식
- 로그인 관련 내용 테이블 위치
- 회원 테이블 따로 분리할지 -> 논의
- 아파트-원룸-주택 테이블 따로 분리할지 -> 논의 

### 4) 시스템 설계
front(Vue) - back(Spring) - DB(mysql)

### 5) 백엔드 설계
1. 필터 --> ?
2. 인터셉터 --> 권한체크(토큰검증)
3. AOP --> 로깅
4. 에러핸들링 --> @RestControllerAdvice 

### 6) 인증 설계
- 토큰이 보안상 문제가 되는 이유: 사용자 정보 노출, 토큰 탈취
- 토큰 어떤식으로 관리할지 
  - --> 서비스 중요도에 따라 인증을 달리한다
  - admin: DB 저장이 좋지 않을까
  - 일반적인 토큰: DB저장 X 그냥 검증만
- 토큰에 정보 뭐넣을지 
  - 최소한의 식별 가능한 정보만 넣는다
  - 어차피 사용자 인증이 필요한 행위는 DB에서 사용자 정보까지 가게 되어있을듯...
- 쿠키? 세션스토리지? 어떻게? --> 
  - 쿠키: [https | secure | ?]
  - 우리가 꼭 js에서 접근할만한 이유가 있는가????

### 7) 보안 설계

### 8) 프론트 설계
