### 1. 왜 SpringSecurity에서는 CSRF를 비활성화할까?

- REST API, B2B 상황, 브라우저를 사용하지 않는 상황을 고려하면 CSRF 취약점이 적다. 따라서 CSRF를 disabled로 설정하는 경우가 있다.

### 2. 우리가 CSRF가 필요한 이유

- CSRF는 사용자의 권한으로 수행되는 요청을 통해 악의적인 행위를 수행하는 것이다.
- 쿠키를 사용한 인증 방식을 사용하게 되면 취약점이 생긴다.
- 사용자는 모르는 상태에서 사용자 권한을 통한 요청이 가기 때문에 시스템적으로 확인하는 과정이 필요하다.
- 입찰 과정에서 CSRF 공격을 통해 악의적인 입찰 요청이 들어갈 수 있다.

### 3. REST API에서 CSRF 토큰을 쓴다면?

- 토큰 인증 방식을 사용하게 되면 쿠키에 same site, http only 옵션을 주는 방법, 적절한 CORS를 설정하는 방법, CSRF 토큰을 발급하는 방법 등을 이용하여 CSRF 취약점을 방어할 수 있다.

### 4. 적용 가능한 방법 시나리오

- 사용자가 로그인하면 서버는 JWT를 생성하여 클라이언트에 전달합니다.
  클라이언트는 JWT를 로컬 스토리지 또는 세션 스토리지에 저장합니다.
  이후 요청마다 클라이언트는 JWT를 Authorization 헤더에 포함시켜 서버로 전송합니다.
  => XSS 취약점 있음
- 사용자가 로그인하면 서버는 CSRF 토큰을 생성하고 클라이언트에 전달합니다.
  클라이언트는 이 CSRF 토큰을 요청 헤더에 포함시켜 서버로 전송합니다.
  서버는 요청을 받을 때마다 CSRF 토큰을 검증하여 요청의 정당성을 확인합니다.

### 5. 최종 선택 및 추후 확장

- 입찰의 마지막 과정에서 CSRF 공격을 방어하기 위해 사용자 핸드폰 인증 후 경매 별 간편 비밀번호를 생성하여 경매 내에서 사용하게 했다.
- 하지만 네트워크 탈취를 통한 간편 비밀번호 탈취가 일어날 수 있기 때문에 간편 비밀번호를 매 입찰 마다 만들어서 제공해야한다.
- 즉, 간편 비밀번호 발급을 하지 않고 otp를 핸드폰 인증 자체로 하여 입찰에 대한 CSRF 공격을 방어할 수 있다.